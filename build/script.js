function getAllCourses(e){async.map(courseQ,function(e,t){gen.getJSON(e,term,function(e){t(null,e)})},function(t,n){e(null,n)})}function conflictCheck(e,t){function n(u,o){o==e.length?t(null,u):(u=r(u,o),n(u,o+1))}function r(t,n){for(var r=e[n],u=[],o=0;o<t.length;o++)for(var i=0;i<r.length;i++)time.sectionCheck(t[o],r[i])&&u.push(t[o].concat(r[i]));return u}n(e[0],1)}function display(e){e.map(function(e){return e.map(function(e){var t={};return t.type=e.type,t.title=e.title,t.section_title=e.section_title,t.day=e.day,t.start=e.start_time,t.end=e.end_time,t})})}function generateInfo(e,t,n,r){query.requestSection(e,t,n,function(e){var t={};e.forEach(function(e){var n=Object.keys(t),r=e.type;n.indexOf(r)>-1?t[r].push(e):(t[r]=[],t[r].push(e),n.push(r))}),r(t,e)})}function setIndexGenerator(e,t,n){function r(e,t,n){e.length-1;n.push(e.map(function(e,n,r){return t[n][e]}))}function u(e,t,n,o,i){if(0===e.length)r(o,t,n);else{var c=e.slice(1);for(o[i]=0;o[i]<e[0];++o[i])u(c,t,n,o,i+1)}}u(e,t,n,[],0)}function answerOK(e,t){function n(e){var t=e.length-1;return e.every(function(e,n,r){return t>n&&time.conflict(e,r[n+1])?!1:!0})}var r=e.filter(n);t(r)}function getJSON(e,t,n){var r=e.split("-")[0],u=[];generateInfo(e,r,t,function(e,t){var r=Object.keys(e).map(function(t){return e[t]}),o=Object.keys(e).map(function(t){return e[t].length});setIndexGenerator(o,r,u),answerOK(u,n)})}function requestDept(e,t,n){var r=require("request"),u="http://web-app.usc.edu/web/soc/api/classes/"+e+"/"+t;r(u,function(e,t,r){if(!e&&200==t.statusCode){var u=JSON.parse(r),o=u.OfferedCourses.course;n(o)}})}function requestCourse(e,t,n,r){requestDept(t,n,function(t){var n=t.filter(function(t){return t.PublishedCourseID==e});r(n)})}function requestSection(e,t,n,r){requestCourse(e,t,n,function(e){var t=e[0].CourseData.SectionData;r(t)})}function conflict(e,t){var n=convertToMin(e.start_time),r=convertToMin(e.end_time),u=convertToMin(t.start_time),o=convertToMin(t.end_time);if(e.day.length>1||t.day.length>1){for(var i=e.day.split(""),c=t.day.split(""),s=0;s<i.length;s++)for(var f=0;f<c.length;f++)if(i[s]==c[f]){if(n==u)return!0;if(u>n){if(r>u)return!0}else if(o>n)return!0}return!1}return e.day===t.day?n===u?!0:u>n?r>u:conflict(t,e):!1}function convertToMin(e){var t=e.split(":"),n=60*t[0]+t[1];return n}function sectionCheck(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<t.length;r++)if(conflict(e[n],t[r]))return!1;return!0}var gen=require("./generator.js"),async=require("async"),time=require("./timeutil.js"),courseQ=["CORE-102","CORE-111","CHEM-105A","ENGR-102"],term=20161;async.waterfall([getAllCourses,conflictCheck,display],function(e){});var query=require("./request-course.js"),time=require("./timeutil.js");module.exports.getJSON=getJSON,module.exports.requestDept=requestDept,module.exports.requestCourse=requestCourse,module.exports.requestSection=requestSection,module.exports.conflict=conflict,module.exports.sectionCheck=sectionCheck;